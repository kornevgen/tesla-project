\section{Решение системы зависимостей адресов в виде логической
программы}\label{address_deps_clp}

Сама схема тестовой программы находится в комментариях логической
программы

{ \small

\begin{verbatim}
:- module( lru ).

:- lib( ic_sets ). :- lib( ic ).

go( Vars ) :-
    C4 = 4,
    C3 = 3,
    C2 = 2,
    C1 = 1,

    % miss C5 -> C4
    C5 #:: [ 1 .. 5 ],
    C5 #\= C1, C5 #\= C2, C5 #\= C3, C5 #\= C4,

    intset( S1, 1, 5 ), #( S1, 4 ),
    C1 in S1, C2 in S1, C3 in S1, C5 in S1,

    % hit X1
    X1 in S1,
    intset( TX1, 1, 5 ), #( TX1, 1 ), X1 in TX1,

    % miss X3 -> X2
    X2 in S1,
    X3 #:: [ 1 .. 6 ], X3 notin S1,
    intset( TX2, 1, 5 ), #( TX2, 1 ), X2 in TX2,
    intset( TX3, 1, 6 ), #( TX3, 1 ), X3 in TX3,
    S2 = (( S1 \ TX2 ) \/ TX3),

    % hit X4
    X4 in S2,
    intset( TX4, 1, 5 ), #( TX4, 1 ), X4 in TX4,

    % hit X5
    X5 in S2,
    intset( TX5, 1, 5 ), #( TX5, 1 ), X5 in TX5,

    % miss X7 -> X6
    X6 in S2,
    intset( TX6, 1, 6 ), #( TX6, 1 ), X6 in TX6,

    % lru( X6 ) /\ lru( X2 )
    ( CaseX5 = 6, X6 #= X1, S2 \ TX6 sameset TX3 \/ TX4 \/ TX5
    ; CaseX5 = 5, X6 = C5, S2 \ TX6 sameset TX1 \/ TX3 \/ TX4 \/ TX5
    ; CaseX5 = 4, X6 = C1, S2 \ TX6 sameset [ C5 ] \/ TX1 \/ TX3 \/ TX4 \/ TX5
    ; CaseX5 = 3, X6 = C2, S2 \ TX6 sameset [ C1, C5 ] \/ TX1 \/ TX3 \/ TX4 \/ TX5
    ),

    CaseX2 #< CaseX5,

    ( CaseX2 = 3, X2 = C2, T2 = [ C1, C5 ], S1 \ TX2 sameset T2 \/ TX1
    ; CaseX2 = 2, X2 = C3, T2 = [ C2, C1, C5 ], S1 \ TX2 sameset T2 \/ TX1
    ),

    Vars = [ C5, X1, X2, X3, X4, X5, X6 ],
    labeling( Vars ) .
\end{verbatim}
}
