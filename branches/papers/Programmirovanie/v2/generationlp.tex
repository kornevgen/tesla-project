\section{Алгоритм генерации единой логической
программы}\label{genlp}

После выполнения преобработки все зависимости между переменными
величинами в схеме выразимы в виде ограничений над числами
(сравнения, битовые операции, арифметические операции), в том числе
и зависимости между адресами. Множество переменных составляют
регистры и теги сетов, с которыми работает тестовая программа. В
результе свой работы логический интерпретатор построит значения этих
переменных перед исполнением тестовой программы, при которых
происходят заданные тестовые ситуации. Для найденных значений
необходимо вставить перед тестовой программой инициализирующую
программу (см. п.~\ref{scheme}). Некоторые значения переменных могут
быть известны перед построением тестовой программы по ее схеме.
Тогда можно ставить задачу генерации таких значений переменных, при
которых размер инициализирующей программы будет минимален. Особенно
это важно для команд инициализации состояния кэш-памяти, потому как
при этом могут возникать дополнительные ситуации в других
подсистемах процессора.

Алгоритм состоит из последовательной трансляции описаний тестовых
ситуаций в логические ограничения. Если происходит присваивание, то
ддя изменяемой переменной создается новая логическая переменная со
следующим номером версии (согласно механизму версионности). Также в
логическую программу добавляются ограничения на переменные-адреса,
полученные из преобработки команд работы с памятью (равенства и
неравенства). При осуществлении трансляции необходимо следить за
тем, чтобы не получить зацикливающуюся логическую программу.
Например, она может получиться при наличии операторов цикла в
описаниях тестовых ситуаций или реализации операций с числами,
размер которых неизвестен в процессе построения логической
программы. Для избежания второго эффекта можно перед генерацией
логической программы провести вычисления битовых размеров переменных
на основе определения операций, например, суммируются числа
одинакового битового размера с результатом того же битового размера,
битовый размер присваиваемого выражения совпадает с битовым размеров
изменяемой переменной и т.п.
