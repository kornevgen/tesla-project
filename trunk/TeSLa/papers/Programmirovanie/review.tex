\section{Обзор работ по системному функциональному тестированию
микропроцессоров}

В настоящее время в практике тестирования микропроцессоров
распространены следующие подходы:
\begin{itemize}
\item ручная разработка тестовых программ;
\item тестирование с использованием кросс-компиляции;
\item случайная генерация тестовых программ;
\item случайная генерация тестовых программ на основе тестовых
шаблонов.
\end{itemize}

Ручная разработка тестовых программ хоть и практически неприменима
для полного тестирования микропроцессора, всё же может применяться
для тестирования особых, крайних, случаев поведения
микропроцессоров. Тестирование с использованием кросс-компиляции
применяется часто за счет невысокой сложности проведения
тестирования: после согласования спецификации микропроцессора можно
начинать делать кросс-компилятор, а код, предназначенный для
кросс-компиляции, уже готов. Однако гарантировать полноту такое
тестирование не может. Случайная генерация тестовых программ
применяется так же часто за счет простоты автоматизации. Такие
тестовые программы позволяют быстро обнаружить простые ошибки,
однако опять же не гарантируют полноты тестирования. Разрабатываются
и более хитрые варианты случайной генерации~\cite{muGP}. Случайная
генерация на основе тестовых шаблонов предполагает разделение
процесса генерации тестовой программы на два этапа: на первом
подготавливаются \emph{тестовые шаблоны} -- абстрактные
представления будущих тестовых программ (вместо указания конкретных
параметров инструкций в тестовых шаблонах указывается ограничения на
параметры) -- а на втором этапе по тестовым шаблонам генерируются
тестовые программы. Второй этап включает в себя генерацию тестовых
данных, т.е. генерацию начальных значений регистров, ячеек
кэш-памяти, строк TLB и т.д., а также констант тестовой программы.

В решении задачи генерации тестовых данных можно выделить следующие
подходы:
\begin{itemize}
\item комбинаторные техники
\item сведение к задаче ATPG
\item сведение к задаче разрешения ограничений
\end{itemize}

\emph{Комбинаторные техники} применимы в случае простых тестовых
шаблонов. Ограничениями на переменные в таких тестовых шаблонах
являются указания домена. Все значения в домене равноправны и могут
появиться в тестовой программе. Однако данная техника требует
доведения всех ограничений в тестовом шаблоне до простой формы
(ограничение домена переменной), что удается сделать не всегда. В
работе исследователей из Fujitsu Lab.~\cite{TSE} предлагается
описывать тестовые программы в виде выражений (Test Specification
Expressions, TSE) и описывать инструкции микропроцессора на языке
ISDL. Специальный генератор строит тестовые программы,
удовлетворяющие TSE. Kohno и Matsumoto рассматривают задачу
верификации конвейерных микропроцессоров, сводя ее к генерации
тестовых программ. В процессе своей работы генератор строит тестовый
шаблон, к которому применяются также комбинаторные техники. Доменами
переменных являются множество регистров и множество констант,
допустимых в качестве значений параметров инструкций.

Исследователи из Politecnico di Milano~\cite{toATPG} предложили
решать задачу генерации тестовых данных путем ее \emph{сведения к
задаче ATPG} (Automatic Test Pattern Generation). Задача ATPG
известна давно и для ее решения существуют соответствующие
инструменты. Для применения таких методик необходимо использовать
RTL-модель микропроцессора, а, значит, его модель к моменту
генерации тестовых данных должна уже быть готова. Кроме того,
использование такой методики для функционального тестирования
достаточно опосредовано, поскольку тесты здесь строятся и с учетом
спроектированного микропроцессора, который затем же будет и
тестироваться.

Наиболее впечатляющих результатов достигают инструменты,
\emph{сводящие задачу генерации тестовых данных к задаче разрешения
ограничений}. Кроме тестового шаблона в таких инструментах требуется
описать поведение микропроцессора в требуемых тестовых ситуациях.
Исследователи из Китайского Национального Университета Технологий
Безопасности~\cite{MAATG} для этого используют описание
микропроцессора на языке EXPRESSION, а тестовый шаблон содержит
простейшие ограничения типа равенства-неравенства значений и задание
домена. В компании IBM уже не один десяток лет ведутся разработки
инструментов генерации тестовых данных для тестирования
микропроцессоров. Их инструмент Genesys-Pro~\cite{GenesysPro2004}
вполне справляется с этой задачей. Поведение микропроцессора
описывается в виде тех же ограничений (constraint net) на элементы
структуры инструкции (операнды, код операции, поля операндов), что
не является естественным описанием поведения
микропроцессора~\cite{GenesysPro2004Innovations}. Кроме того
инструмент не использует функциональные связи разных команд, а
генерирует значения параметров очередной команды, исходя из уже
построенной части тестовой программы до этой команды. Иными словами,
тестовая программа строится по-командно, что может отрицательно
сказаться на эффективности работы Genesys-Pro на больших тестовых
шаблонах.

В данной работе задача генерации тестовых данных также сводится к
задаче разрешения ограничений. Однако при этом учитываются
зависимости разных инструкций в тестовом шаблоне, тестовые ситуации
описываются на языке, приближенном к императивным языкам
программирования, а в тестовых шаблонах можно указывать довольно
сложные тестовые ситуации, такие как промахи в кэш-памяти или TLB,
довольно просто, не теряя возможности генерации по ним тестовых
данных.
