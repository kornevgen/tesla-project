\chapter*{Введение}
\addcontentsline{toc}{chapter}{Введение}

\section*{Актуальность}

Современные программные и аппаратные системы зачастую обладают
сложным внутренним устройством и логикой работы. Для повышения
эффективности работы этих систем применяются в том числе и механизмы
кэширования. В микропроцессорах используется иерархическая
кэш-память, в операционных системах используется аппарат виртуальной
памяти, включающий в себя кэширование и управления страницами
виртуальной памяти, системы управления базами данных используют
кэширование для ускорения выдачи данных, удовлетворяющих запросам,
кэширование применяется и для оптимизации работы в компьютерных
сетях. С увеличением сложности таких систем возрастает вероятность
ошибки при их реализации.

Для обнаружения ошибок применяются различные методы, такие как
статический анализ, тестирование, мониторинг, формальная
верификация, верификация на моделях и
прочие~\cite{Kuliamin_verification}. Данная работа посвящена одному
из таких методов, а именно тестированию. Одним из видов тестирования
является функциональное тестирование, или тестирование интерфейса
системы~\cite{Kuliamin_course}.

Тестирование интерфейса системы осуществляется подачей специальных
\emph{тестовых воздействий} (последовательностей стимулов),
наблюдением за работой системы или, как минимум, фиксацией реакций
системы на тестовое воздействие, и, наконец, вынесением вердикта о
соответствии реакций системы требованиям, предъявляемым к системе.
Каждое тестовое воздействие моделируется как последовательность
обращений к интерфейсным операциям с некоторым набором
аргументов~\cite{UniTESK}. При наличии требований, сформулированных
в формальном виде, в качестве критерия тестового покрытия может быть
выбрано покрытие элементов требований. Современные системы
отличаются большим количеством требований, поэтому для обеспечения
достаточного качества тестирования (достаточного покрытия элементов
требований) приходится использовать большое количество тестовых
воздействий -- не менее одного для каждого элемента покрытия. Такие
тестовые воздействия обладают большим количеством внутренних
зависимостей и требований на тестовые данные -- значения аргументов
интерфейсных операций и состояние системы перед тестовым
воздействием. Всё это приводит к уменьшению количества допустимых
тестовых данных и уменьшению эффективности применения переборных и
вероятностных алгоритмов построения тестовых данных~\cite{DART}.

Тем не менее в такой области построения тестовых воздействий, как
построения тестов и верификация микропроцессоров, последние годы
сделан существенный шаг вперед~\cite{Bryant, GenesysPro}. Он связан
с использованием алгоритмов, которые позволяют выражать отношения на
объектах и строить эффективные \emph{процедуры разрешения} этих
отношений (\emph{ограничений}) с целью построения объектов, на
которых заданные отношения выполнены~\cite{CSP}. Такие методы
получили название методов генерации тестов \emph{с использованием
ограничений}. Однако задача построения эффективных процедур
разрешения систем ограничений в общем случае является нетривиальной
задачей. Поэтому следует ограничиться некоторым классом тестируемых
систем и в данной работе это будут микропроцессоры.

Тестирование микропроцессоров является неотъемлемой частью процесса
их разработки. Тестирование может осуществляться на этапе
проектирования микропроцессора, такое тестирование называют
\emph{имитационным}. Функциональное тестирование микропроцессоров
может проводиться на системном или модульном уровне. При
\emph{системном тестировании} тестовым воздействием является
программа на языке ассемблера микропроцессора (\emph{тестовая
программа}). При \emph{модульном тестировании} тестовым воздействием
является сигнал, подаваемый на интерфейсные входы тестируемого
модуля. Системное тестирование микропроцессора оказывается дешевле
модульного тестирования, поскольку не нужно предварительно выделять
модуль из всего микропроцессора, подводить к его входам нужные
сигналы и принимать выходные и промежуточные сигналы.

В случае функционального тестирования микропроцессоров интерфейсными
операциями являются инструкции микропроцессора, тестовыми
воздействиями -- программы на языке ассемблера микропроцессора,
требования на тестовые воздействия оформляются специальным образом в
виде \emph{тестовых шаблонов}~\cite{GenesysPro}. Была показана
эффективность систематического построения тестовых шаблонов (на
основе модели микропроцессора)~\cite{kamkin}, однако описанный
способ построения тестовых воздействий по таким тестовым шаблонам
включал большую долю ручной работы. Поэтому представляется
перспективным объединить предложенные систематические методы
построения тестовых шаблонов и методы построения тестовых
воздействий с помощью ограничений для автоматизации построения
тестовых программ. Это поможет снизить трудозатраты на их подготовку
 и ускорить выполнение тестирования.


%Поэтому представляется перспективным уделить особое внимание именно
%автоматизации построения тестовых программ по тестовым шаблонам с
%использованием ограничений для системного тестирования
%микропроцессоров.
%
%
%
%
%Однако задача построения эффективных процедур разрешения систем
%ограничений в общем случае является нетривиальной задачей. Для
%некоторых классов ограничений исследованы и построены отдельные
%процедуры разрешения. Поэтому представляется перспективным
%исследование методов генерации специальных систем ограничений для
%тестовых шаблонов с целью задействовать имеющиеся процедуры
%разрешения ограничений и тем самым снизить сложность процесса
%генерации тестовых воздействий.
%
%Тестирование микропроцессоров является неотъемлемой частью процесса
%их разработки. Тестирование может осуществляться на этапе
%проектирования микропроцессора, такое тестирование называют
%\emph{имитационным}. Функциональное тестирование микропроцессоров
%может проводиться на системном или модульном уровне. При
%\emph{системном тестировании} тестовым воздействием является
%программа на языке ассемблера микропроцессора (\emph{тестовая
%программа}). При \emph{модульном тестировании} тестовым воздействием
%является сигнал, подаваемый на интерфейсные входы тестируемого
%модуля. Системное тестирование микропроцессора оказывается дешевле
%модульного тестирования, поскольку не нужно предварительно выделять
%модуль из всего микропроцессора, подводить к его входам нужные
%сигналы и принимать выходные и промежуточные сигналы. Поэтому
%представляется перспективным уделить особое внимание именно
%автоматизации построения тестовых программ по тестовым шаблонам с
%использованием ограничений для системного тестирования
%микропроцессоров.

Тестовое воздействие включает в себя перевод микропроцессора в
некоторое специальное состояние. При этом возможные ошибки могут
проявиться уже при этом переводе. Поэтому представляется
перспективным исследование методов построения тестовых воздействий
небольшой длины и методов построения тестовых программ по тестовым
шаблонам с использованием начального состояния микропроцессора, что
тоже нацелено на сокращения размера тестового воздействия.

\section*{Цели и задачи работы}

Целью диссертационной работы является исследование и разработка
методов автоматического построения тестовых программ по тестовым
шаблонам. Для достижения цели были поставлены следующие задачи:
\begin{itemize}
  \item провести анализ существующих методов построения тестовых
  программ;
  \item разработать новые методы построения тестовых программ по
  тестовым шаблонам, которые позволяют снизить сложность процедуры
  генерации ограничений и их разрешения;
  \item провести апробацию предложенных методов для современных
  архитектур микропроцессоров.
\end{itemize}

\section*{Основные результаты работы}

Основные научные результаты, полученные в рамках диссертационной
работы и выносимые на защиту, состоят в следующем:

\begin{enumerate}
\item метод генерации ограничений (т.н. \emph{совместная
генерация ограничений}) для тестовых шаблонов, нацеленных на
тестирование инструкций обращения к памяти, с использованием
заданного начального состояния микропроцессора;
\item метод \emph{зеркальной генерации} ограничений для тестовых
шаблонов, нацеленных на тестирование инструкций обращения к памяти,
без использования начального состояния микропроцессора;
\item метод описания стратегий вытеснения в кэш-памяти в виде
ограничений \emph{перебором диапазонов вытеснения}, т.е. части
тестового шаблона, непосредственно влияющего на вытеснение;
\item метод описания стратегий вытеснения в кэш-памяти в виде
ограничений \emph{с использованием функций полезности}, т.е.
ограничений на количество инструкций, способствующих вытеснению.
\end{enumerate}

%\begin{enumerate}
%\item новый метод генерации тестовых данных (т.н. \emph{совместная
%генерация ограничений}) для тестирования инструкций обращения к
%памяти; позволяет снизить сложность написания генератора,
%рассматривая наиболее часто встречающиеся механизмы работы с памятью
%и используя привычные общедоступные решатели задач; совместная
%генерация стала возможной при рассмотрении содержимого кэш-памяти
%как множества;
%\item новый метод описания тестовых ситуаций в кэш-памяти в виде
%ограничений \emph{перебором диапазонов вытеснения};
%\item новый метод описания тестовых ситуаций в кэш-памяти в виде
%ограничений \emph{с использованием функций полезности};
%\item новый метод \emph{зеркальной генерации} тестовых данных для
%тестирования подсистемы обращения к памяти;
%\item новый метод генерации ограничений для тестовых ситуаций в
%кэш-памяти при наличии в ней <<грязных>> ячеек (для стратегии
%вытеснения \LRU);
%\item компактное описание стратегии \LRU с помощью ограничений.
%\end{enumerate}

\section*{Научная новизна работы}

%дополнительная новизна: задача генерации тестовых данных \emph{с
%учетом заданного начального состояния микропроцессора} ранее не
%рассматривалась в литературе (в том числе и разработчиками
%Genesys-Pro).

Следующие результаты являются новыми:
\begin{enumerate}
\item модель модулей управления памятью микропроцессоров;
\item метод совместной генерации ограничений для тестовых шаблонов;
\item метод зеркальной генерации ограничений для тестовых
шаблонов;
\item метод перебора диапазонов вытеснения для описания стратегий вытеснения;
\item метод функций полезности для описания стратегий вытеснения;
\item определение стратегии вытеснения \PseudoLRU на ветвях
бинарного дерева.
\end{enumerate}

\section*{Практическая значимость}

Результаты диссертации могут быть использованы в проектах по
функциональному тестированию микропроцессорных систем
(RISC-архитектуры, некоторые CISC-архитектуры), операционных систем,
в работах, связанных с исследованием механизмов кэширования и
трансляции адресов.

Практическая значимость подтверждается применимостью предложенных
идей к практически значимым архитектурам микропроцессоров и тестовым
шаблонам.

\section*{Доклады и публикации}

Основные результаты диссертации докладывались на следующих
конференциях и семинарах:
\begin{itemize}
\item Второй весенний коллоквиум молодых исследователей в области программной
инженерии (SYRCoSE: Spring Young Researchers Colloquium on Software
Engineering, г. Санкт-Петербург, 2008 г.);
\item XVI Международная конференция студентов, аспирантов и молодых учёных
<<Ломоносов>> (г.Москва, 2009 г.);
\item XVI Всероссийская межвузовская научно-техническая конференция студентов
и аспирантов <<Микроэлектроника и информатика - 2009>> (г.Москва,
Зеленоград, 2009 г.);
\item Третий весенний коллоквиум молодых исследователей в области программной
инженерии (SYRCoSE: Spring Young Researchers Colloquium on Software
Engineering, г. Москва, 2009 г.);
\item IV летняя международная школа аспирантов по научным
вычислениям (г.Москва, 2009 г.);
%\item EWDTS-2009
\item Семинарах Института системного программирования РАН (г. Москва, 2009
г.).
\end{itemize}

По материалам диссертации опубликованы работы \cite{my_syrcose_2008,
my_isp_2008, my_lomonosov_2009, my_miet_2009, my_nivc_2009,
my_syrcose_2009, my_isp_2009, my_ewdts_2009,
my_programmirovanie_2009}, полно отражающие основные результаты
диссертации.

\section*{Структура и объем диссертации}

Работа состоит из введения, 5 глав, заключения, списка литературы
(74 наименований) и приложения. Основной текст диссертации (без
приложения и списка литературы) занимает 153 страницы.

\section*{Краткое содержание работы}

Первая глава является обзорной и содержит описание методов
построения тестовых программ по тестовым шаблонам, примененных в
различных промышленных проектах по тестированию микропроцессоров, а
также методы построения генераторов тестовых программ.
Рассматриваются построение генераторов вручную, комбинаторные
методы, использование задачи ATPG~\cite{toATPG} и использование
ограничений. Описываются достоинства и недостатки различных методов.
Основное внимание уделяется качеству генерируемых тестовых программ,
полноте и применимости методов. В конце главы дается анализ
существующих методов генерации тестовых программ по тестовым
шаблонам, уточняются цели и задачи диссертационной работы.
Завершается глава предварительными сведениями и терминами, полезными
при чтении остальной части диссертации. К таковым относятся
описанием типов кэш-памяти, представление стратегий вытеснения в
виде таблиц вытеснения и небольшой обзор методов разрешения
ограничений.

Во второй главе описываются предлагаемые автором методы генерации
ограничений для тестовых шаблонов, нацеленных на тестирование
механизмов кэширования, и модель модулей управления памятью, на
основе которой происходит выделение ограничений. Рассматриваются
предлагаемые автором методы совместной и зеркальной генерации. В
основе совместного метода генерации ограничений лежит возможность
сокращения размера ограничений для инструкций, которые обращаются к
нескольким подсистемам микропроцессора в процессе своего исполнения.
Метод позволяет эффективно выбрать часть начального состояния
микропроцессора, действительно влияющую на исполнение инструкции, и
тем самым сократить размер ограничений. Формулируются и доказываются
теоремы корректности и условной полноты совместной генерации
ограничений (полнота при условии, что состояние кэширующих подсистем
микропроцессора не меняется перед исполнением инструкций тестового
шаблона). В основе зеркального метода генерации ограничений лежит
эвристика о том, что любой адрес в программе должен появиться как
минимум дважды для гарантирования его тестовой ситуации при
повторных обращениях: вне зависимости от начального состояния
микропроцессора каждый элемент тестового воздействия должен быть
предварительно подготовлен последовательностью инструкций,
начинающихся с обращения к тому же элементу. Зеркальный метод
генерации ограничений дополняет метод совместной генерации
ограничений. В отличие от совместной генерации зеркальная генерация
дает решение, если оно существует, правда, большей длины, чем длина
тестовой программы от совместной генерации. Формулируются и
доказываются теоремы о корректности и полноте зеркального метода
генерации ограничений. Эти теоремы формально обосновывают применение
зеркального метода. Также в разделе формулируется и доказывается
теорема о дизъюнктивном представлении тестовых ситуаций. Эта теорема
дает способ генерирования ограничений для тестовых ситуаций в
кэширующих буферах на основе изменений содержимого кэширующих
буферов как множества.

В третьей главе описываются предлагаемые автором методы генерации
ограничений, описывающих стратегию вытеснения в кэширующих буферах.
Это методы перебора диапазонов вытеснения и метод функций
полезности. Метод перебора диапазонов вытеснения позволяет записать
ограничения лишь на часть тестового воздействия, непосредственно
влияющую на вытеснение в данной инструкции. Метод функций полезности
предлагает описать вытеснение как ограничение на количество
\emph{полезных к вытеснению} инструкций. В разделе формалируются и
доказываются теоремы о корректности и полноте применения
предлагаемых методов генерации ограничений, описывающих стратегию
вытеснения для стратегий вытеснения \LRU, \FIFO и \PseudoLRU. В
начале главы дается новое определение стратегии вытеснения
\PseudoLRU (определение <<на ветвях бинарного дерева>>),
показывается его эквивалентность другим определениям этой стратегии
вытеснения. Определение <<на ветвях бинарного дерева>> полезно для
исследований стратегии вытеснения с точки зрения одного вытесняемого
тега (другие определения описывают изменение всего набора тегов).

В четвертой главе главе описывается программная реализация
генератора ограничений. Описывается архитектура генератора, процесс
подготовки входных данных и формат описания тестовых шаблонов и
особенностей архитектуры микропроцессора.

В пятой главе описываются результаты апробации предлагаемых автором
методов построения тестовых программ по тестовым шаблонам с
использованием ограничений. А именно в главе показывается, как с
использованием предлагаемых методов сгенерировать ограничения,
описывающие работу MMU микропроцессоров для таких архитектур как
PowerPC, Alpha, MIPS и Pentium. Для каждой архитектуры на примере
одного из микропроцессоров составляется структура MMU и показываются
схемы совместной генерации ограничений. Для микропроцессора
архитектуры MIPS приведены результаты экспериментов с прототипом
генератора тестовых программ, реализованным автором работы. Основным
результатом главы является обоснование того, что предлагаемые
автором методы достаточны для применения при тестировании
современных архитектур микропроцессоров и соответствуют поставленным
в работе целям.
