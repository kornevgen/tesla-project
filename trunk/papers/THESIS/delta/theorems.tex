% !Mode:: "TeX:UTF-8"
\newcommand{\LcurrentBody}{
Пусть $L_0$ -- множество ключей, расположенных в некотором регионе таблицы перед исполнением инструкций тестового шаблона, $x_1$, $x_2$, ..., $x_n$ -- последовательность ключей того же региона, по которым происходят обращения с промахами в том же порядке, что и в тестовом шаблоне, $x'_1, x'_2, ..., x'_n$ -- последовательность ключей, вытесняемых обращениями к $x_1$, $x_2$, ..., $x_n$. Тогда $L$ -- выражение для множества ключей таблицы того же региона после этих обращений имеет вид:
$$L \equiv L_0 \setminus \bigcup_{i=1}^n \{x'_i\} \cup \bigcup_{i=1}^n (
\{x_i\} \setminus \cup_{j~=~i+1}^n \{x'_j\}).$$
}

\newcommand{\HitMissEquations}{
Пусть $L_0$ -- множество ключей, расположенных в таблице в некотором регионе перед исполнением инструкций тестового шаблона, $x_1, x_2, ..., x_n$ -- последовательность ключей того же региона, по которым происходят обращения с промахами в том же порядке, что и в
тестовом шаблоне, $x'_1$, $x'_2$, ..., $x'_n$ -- последовательность ключей, вытесняемых обращениями к $x_1$, $x_2$, ..., $x_n$. Тогда для обращения после этих по ключу $x$ в тот же регион справедливы следующие уравнения:
\begin{itemize}
\item для обращения с попаданием:
$$
\left[
   \begin{array}{l}
    x \in L_0 \wedge x \notin \{x'_1, x'_2, ..., x'_n\} \\
    x = x_1 \wedge x \notin \{x'_2, ..., x'_n\} \\
    x = x_2 \wedge x \notin \{x'_3, ..., x'_n\} \\
    ...\\
    x = x_{n-1} \wedge x \notin \{x'_n\} \\
    x = x_n \\
   \end{array}
  \right.
$$

\item для обращения с промахом ($x'$ --- вытесняемый ключ):
$$
\left\{
   \begin{array}{l}

  \left[
   \begin{array}{l}
    x \notin L_0 \wedge x \notin \{x_1, x_2, ..., x_n\} \\
    x = x'_1 \wedge x \notin \{x_2, ..., x_n\} \\
    x = x'_2 \wedge x \notin \{x_3, ..., x_n\} \\
    ...\\
    x = x'_{n-1} \wedge x \notin \{x_n\} \\
    x = x'_n \\
   \end{array}
  \right. \\

  { }\\

  \left[
   \begin{array}{l}
    x' \in L_0 \wedge x \notin \{x'_1, x'_2, ..., x'_n\} \\
    x' = x_1 \wedge x \notin \{x'_2, ..., x'_n\} \\
    x' = x_2 \wedge x \notin \{x'_3, ..., x'_n\} \\
    ...\\
    x' = x_{n-1} \wedge x \notin \{x'_n\} \\
    x' = x_n \\
   \end{array}
  \right. \\

  { }\\

  displaced(x')\\

%  { }\\
%
%  R(x) = R(x')\\
%
  \end{array}
\right.
$$

\end{itemize}
}

\newcommand{\CorrectnessMirror}{
%Если тестовый шаблон является совместным (т.е. для него существует хотя бы одна тестовая программа), то тестовая программа (инициализация плюс инструкции тестового шаблона), построенная по предлагаемому методу, соответствует тестовому шаблону.
Если построенная для последовательности обращений в таблицу $(S_1, k_1, R_1)$, $(S_2, k_2, R_2)$, ..., $(S_n, k_n, R_n)$ c дополнительным предикатом $P(k_1, k_2, ..., k_n, R_1, R_2, ..., R_n)$ система ограничений является совместной, то ее решение $t_1, t_2, ..., t_m$, $r_1$, $r_2$, ..., $r_m$, $k_1, k_2, ..., k_n$, $R_1, R_2, ..., R_n$, удовлетворяет последовательности $S_1, ..., S_n$ и $P$ при любом начальном состоянии таблицы.
}

\newcommand{\FullnessMirror}{
Если при данном начальном состоянии таблицы для последовательности обращений в нее $(S_1, k_1, R_1)$, $(S_2, k_2, R_2)$, ..., $(S_n, k_n, R_n)$ c дополнительным предикатом $P(k_1, k_2, ..., k_n, R_1, R_2, ..., R_n)$ существует удовлетворяющая ей последовательность ключей, то система ограничений будет совместной, если стратегия вытеснения является <<существенно вытесняющей>>.
}

\newcommand{\PseudoLRUEssential}{
Стратегия вытеснения \PseudoLRU является существенно вытесняющей.
}

\newcommand{\UpperBoundLRUMirror}{
В условиях теоремы~\ref{mirror_fullness} для стратегии вытеснения \LRU достаточно использовать $m$ такое, что
  $$m \leqslant n \cdot w + M$$
  где $M$ -- количество промахов в последовательности $S_1, S_2, ..., S_n$.}

\newcommand{\PseudoLRUInvariant}{
Пусть ($\alpha_1~\alpha_2~\dots~\alpha_W$)
--- \PseudoLRU-ветвь некоторой позиции $i$. Тогда изменение этой
ветви согласно стратегии вытеснения \PseudoLRU определяется только
относительной позицией (относительно $i$) и происходит следующим
образом при обращении к ключу с (абсолютной) позицией $j$: если
$\pi^i_j \in [\frac{w}{2^k},~\frac{w}{2^{k-1}})$ для некоторого
$k=1,2,\dots,W$, то происходит изменение $\alpha_1 := 0,~\alpha_2 :=
0,~\dots,~ \alpha_{k-1} := 0,~\alpha_k := 1$; если $\pi^i_j = 0$, то
происходит изменение $\alpha_1 := 0,~\alpha_2 := 0,~\dots,~\alpha_W
:= 0$; вытеснение ключа на позиции $i$ происходит в том случае, когда
$\alpha_1 = 1~\wedge~\alpha_2 = 1~\wedge~\dots~\wedge~\alpha_W = 1$.
}

%\newcommand{\DiapazonLRU}{
%Решение системы (ключ $x'$)
%$$
%\left\{
%   \begin{array}{l}
%    x' = y \\
%    R(y) \cap (L \setminus \{x_1, x_2, ..., x_n\} ) = \{y\}\\
%   \end{array}
%  \right.
%$$
%где последовательность ключей $y, x_1, x_2, ..., x_n$ -- диапазон
%вытеснения, а $L$ -- множество ключей в таблице перед концом
%диапазона, является вытесняемым ключом для стратегии вытеснения \LRU
%согласно определению на перестановках.
%}
%
%\newcommand{\DiapazonFIFO}{
%Решение системы (ключ $y'$)
%$$
%\left\{
%   \begin{array}{l}
%    y' = y \\
%    R(y) \cap (L \setminus \{y_1, y_2, ..., y_n\} ) = \{y\}\\
%   \end{array}
%  \right.
%$$
%где последовательность ключей $y, y_1, y_2, ..., y_n$ -- диапазон
%вытеснения, является вытесняемым ключом для стратегии вытеснения
%\FIFO согласно определению на перестановках.
%}
%
%\newcommand{\MaxUpperBoundLRU}{
%$$0 \leqslant k \leqslant n \cdot w_1$$
%$$0 \leqslant h \leqslant n \cdot (w_1 + w_2 + 2)$$
%где $w_1$ -- ассоциативность кэш-памяти первого уровня, $w_2$ --
%ассоциативность кэш-памяти второго уровня, $n$ -- количество
%инструкций тестового шаблона.
%}

\newcommand{\LRUusefuls}{
Пусть $(t_1, r_1)$, $(t_2,r_2),$ ..., $(t_m,r_m)$ -- ключи и регионы инструкций инициализирующей последовательности, $(k, R)$ -- ключ и регион инструкции, для которой описывается вытеснение (будем ее называть <<вытесняемой>>), $(k_1,R_1)$, $(k_2,R_2)$, ..., $(k_n,R_n)$ --- ключи и регионы инструкций тестового шаблона, находящихся перед <<вытесняемой>>, причем $(k||R) \in \{(t_1||r_1)$, ..., $(t_m||r_m)$, $(k_1||R_1)$, ..., $(k_n||R_n)\}$ и $\{(t_1||r_1), ...,(t_m||r_m)\}$ --- все разные. Тогда $k$ не вытеснен из региона $R$ согласно определению на перестановках тогда и только тогда, когда $$\sum\limits_{i=1}^{m+n} u_{k,R}(s_i) < w$$
где последовательность $s \equiv \langle (t_1||r_1), ..., (t_m||r_m), (k_1||R_1), ..., (k_n||R_n)\rangle$,\\$R(s_i)$~---~вторая компонента $s_i$ (регион), а функция полезности определена следующим образом:
$$u_{k,R}(s_i) \equiv ((k||R) \notin \{s_i, ..., s_{m+n}\} \wedge
R = R(s_i) \wedge s_i \notin\{s_{i+1},..., s_{m+n}\})$$
}

\newcommand{\PLRUusefuls}{
Пусть $(t_1, r_1)$, $(t_2,r_2),$ ..., $(t_m,r_m)$ -- ключи и регионы инструкций инициализирующей последовательности, $(k, R)$ -- ключ и регион инструкции, для которой описывается вытеснение (будем ее называть <<вытесняемой>>), $(k_1,R_1)$, $(k_2,R_2)$, ..., $(k_n,R_n)$ --- ключи и регионы инструкций тестового шаблона, находящихся перед <<вытесняемой>>, причем $(k||R) \in \{(t_1||r_1)$, ..., $(t_m||r_m)$, $(k_1||R_1)$, ..., $(k_n||R_n)\}$ и $\{(t_1||r_1), ...,(t_m||r_m)\}$ --- все разные. Тогда $k$ не вытеснен из региона $R$ согласно определению на перестановках тогда и только тогда, когда $$\bigvee_{q:1..n:\mbox{miss}} \sum\limits_{i=1}^{m+q} u_{k,R}(s_i) < W$$
где последовательность $s \equiv \langle (t_1||r_1), ..., (t_m||r_m), (k_1||R_1), ..., (k_n||R_n)\rangle$,\\$R(s_i)$ --- вторая компонента $s_i$ (регион), а функция полезности определена следующим образом:
$$u_{k,R} (s_i) \equiv \left\{\begin{array}{l}
(k||R) \notin \{s_i, s_{i+1}, ..., s_{m+n}\}\\
R = R(s_i)\\
P(\pi_i \oplus \pi,~\pi_{i+1} \oplus \pi)\\
P(\pi_i \oplus \pi,~\pi_{i+2} \oplus \pi)\\
... \\
P(\pi_i \oplus \pi,~\pi_{n-1} \oplus \pi)
\end{array}\right.
$$
$$P(x,y) \equiv (y > x~~\wedge~~y \oplus x > x)$$
}